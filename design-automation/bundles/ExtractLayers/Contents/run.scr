(vl-load-com)
(princ "\n=== Layer Extraction v3 ===\n")
(setq layerList '())
(setq layerTable (namedobjdict))
(setq layerDict (dictsearch layerTable "ACAD_LAYER"))
(while (setq layer (tblnext "LAYER" (not layer))) (setq layerList (cons (cdr (assoc 2 layer)) layerList)))
(princ (strcat "\nFound " (itoa (length layerList)) " layers\n"))
(setq output (open "layers.json" "w"))
(if output (progn (princ "[" output) (setq first T) (foreach lyr layerList (if (not first) (princ "," output)) (princ "\"" output) (princ lyr output) (princ "\"" output) (setq first nil)) (princ "]" output) (close output) (princ "\nSuccess\n")) (princ "\nERROR\n"))
(command "_.QUIT" "N")